<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Inventory - AttireFlow</title>
    <meta charset="UTF-8"/>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        table { border-collapse: collapse; width: 100%; }
        th, td { border: 1px solid #ddd; padding: 10px; vertical-align: top; }
        th { background: #f5f5f5; text-align: left; }
        .muted { color: #666; font-size: 0.95em; }
        .actions form { display: inline; margin-right: 8px; }
        .pill { display: inline-block; padding: 2px 8px; border: 1px solid #ddd; border-radius: 999px; margin: 2px 6px 2px 0; }
        a { color: #0b57d0; text-decoration: none; }
        a:hover { text-decoration: underline; }
        button { cursor: pointer; }
    </style>
</head>
<body>
<h1>Inventory</h1>
<p class="muted">
    Showing variants with total stock and stock by location.
    <a href="/">Home</a>
</p>

<table>
    <thead>
    <tr>
        <th>Title</th>
        <th>Category</th>
        <th>Size / Color</th>
        <th>Total Stock</th>
        <th># Locations</th>
        <th>Stock by Location</th>
        <th>Actions</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="row : ${rows}">
        <td th:text="${row.variant.title}">Title</td>
        <td th:text="${row.variant.category}">Category</td>
        <td>
            <span class="pill" th:text="${row.variant.size}">M</span>
            <span class="pill" th:text="${row.variant.color}">Black</span>
        </td>
        <td th:text="${row.totalStock}">0</td>
        <td th:text="${row.locationCount}">0</td>
        <td>
            <div th:if="${#maps.isEmpty(row.stockByLocation)}" class="muted">No stock locations</div>
            <ul th:if="${!#maps.isEmpty(row.stockByLocation)}">
                <li th:each="entry : ${row.stockByLocation}">
                    <strong th:text="${entry.key}">Location</strong>:
                    <span th:text="${entry.value}">0</span>
                </li>
            </ul>
        </td>
        <td class="actions">
            <form th:action="@{'/inventory/' + ${row.variant.id}}" method="get">
                <button type="submit">View Details</button>
            </form>
            <form th:action="@{'/inventory/' + ${row.variant.id} + '/edit'}" method="get">
                <button type="submit">Update</button>
            </form>
            <form th:action="@{'/inventory/' + ${row.variant.id} + '/delete'}" method="post">
                <button type="submit">Delete</button>
            </form>
        </td>
    </tr>
    </tbody>
</table>

</body>
</html>